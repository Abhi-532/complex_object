<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
  <sys_script_include action="INSERT_OR_UPDATE">
    <access>public</access>
    <active>true</active>
    <api_name>sn_msteams_ahv2.MSTeamsErrorHandler</api_name>
    <caller_access/>
    <client_callable>false</client_callable>
    <description>Handles various errors in Microsoft Teams Spoke Actions.</description>
    <name>MSTeamsErrorHandler</name>
    <script><![CDATA[var MSTeamsErrorHandler = Class.create();
MSTeamsErrorHandler.prototype = {
    initialize: function() {},
    genericErrorHandler: function(inputs, outputs) {
        var responseBody = new global.JSON().decode(inputs['responseBody']) || new global.JSON().decode(inputs['responsebody']);
        var errMessage = "";
        var errCode = "";
        if (inputs.status == 404 && responseBody.error && responseBody.error.message) {
            outputs.errorMessage = "Unknown Error";
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("No team found with Group Id") != -1)
                outputs.errorMessage = "A Group with the provided ID does not exist";
            else if ((errMessage.indexOf("No channel found with channel id") != -1) || (errMessage.indexOf("Failed to execute Skype backend") != -1))
                outputs.errorMessage = "No channel is found with the given channel Id";
            else if (errMessage.indexOf("Failed to execute MS Graph") != -1)
                outputs.errorMessage = "Group ID is not valid";
        }
        if (inputs.status == 400 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            errCode = responseBody.error.code;
            if (errMessage.indexOf("groupId needs to be a valid GUID") != -1)
                outputs.errorMessage = "Group ID is invalid";
            else if (errMessage.indexOf("Cannot migrate this group") != -1)
                outputs.errorMessage = "Cannot create Team from a Non Office 365 group";
            else if ((errMessage.indexOf("The request URL is invalid") != -1) || (errMessage.indexOf("The request URI is not valid") != -1) || (errMessage.indexOf("Bad Request - Error in query synta") != -1) || (errMessage.indexOf("Channel.DisplayName doesn't contain allowed characters") != -1))
                outputs.errorMessage = "Group ID should not contain invalid characters";
            else if (errCode.indexOf("UnknownError") != -1)
                outputs.errorMessage = "Input(s) should not contain invalid Characters";
        }
        if (inputs.status == 401 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            outputs.errorMessage = "Unauthorized";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.errorMessage = "Access token is empty. Please Check Oauth Token and scope permission.";
        }
        if (inputs.status == 403 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            outputs.errorMessage = "Forbidden Request. Please Check Oauth Token and scope permission.";
            if (errMessage.indexOf("User is not an owner to perform migration of this Group to Team") != -1)
                outputs.errorMessage = "Access Denied, you are not the owner of the group you are trying to access.";
        }
        if (inputs.status == 405 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Specified HTTP method is not allowed for the request target") != -1)
                outputs.errorMessage = "Group ID should not contain invalid characters";
        }
        if (inputs.status == 409)
            outputs.errorMessage = "A Team with the given Group ID already exist";
        return outputs;
    },
    teamErrorHandler: function(inputs, outputs) {
        var responseBody = new global.JSON().decode(inputs['responseBody']);
        var errMessage = "";
        outputs = this.genericErrorHandler(inputs, outputs);
        if (inputs.status == 404 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if ((errMessage.indexOf("No team found with Group Id") != -1) || (errMessage.indexOf("No Team found with Group id") != -1))
                outputs.errorMessage = "A Team with the provided ID does not exist";
            else
                outputs.errorMessage = errMessage;
        }
        if (inputs.status == 400 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Failed to execute Skype backend request") != -1)
                outputs.errorMessage = "The team you are trying to update is in Archived State";
            else if ((errMessage.indexOf("The request URL is invalid") != -1) || (errMessage.indexOf("The request URI is not valid") != -1) || (errMessage.indexOf("Bad Request - Error in query synta") != -1))
                outputs.errorMessage = "Team ID should not contain invalid characters";
            else if (errMessage.indexOf("is not part of groupId") != -1)
                outputs.errorMessage = "The given channel is not a part of the given team";
            else if (errMessage.indexOf("groupId needs to be a valid GUID") != -1)
                outputs.errorMessage = "Team ID is invalid";
            else if (errMessage.indexOf("Channel.DisplayName doesn't contain allowed characters") != -1)
                outputs.errorMessage = "Channel Name should not contain invalid characters";
            else if (errMessage.indexOf("teamId needs to be a valid GUID") != -1)
                outputs.errorMessage = "Invalid Team ID";
            else if (errMessage.includes("Team already archived"))
                outputs.errorMessage = "The team is already in archived state.";
            else
                outputs.errorMessage = errMessage;
        }
        if (inputs.status == 405 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Specified HTTP method is not allowed for the request target") != -1)
                outputs.errorMessage = "Team ID should not contain invalid characters";
            else
                outputs.errorMessage = errMessage;
        }
        return outputs;
    },
    createChannelErrorHandler: function(inputs, outputs) {
        var responseBody = new global.JSON().decode(inputs['responseBody']);
        var errMessage = "";
        outputs = this.teamErrorHandler(inputs, outputs);
        if (inputs.status == 400 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Channel name already existed") != -1)
                outputs.errorMessage = "A channel with the same Display Name already exists";
            else if (errMessage.indexOf("Channel.DisplayName can't have more than 50 characters") != -1)
                outputs.errorMessage = "Display Name is invalid";
            else if (errMessage.indexOf("Unable to read JSON request payload") != -1)
                outputs.errorMessage = "Input(s) should not contain invalid characters.";
            else if (errMessage.indexOf("teamId needs to be a valid GUID") != -1)
                outputs.errorMessage = "Invalid Team ID";
            else if (errMessage.indexOf("Failed to execute Skype backend request") != -1)
                outputs.errorMessage = "The team you are trying to update is in Archived State";
            else if ((errMessage.indexOf("The request URL is invalid") != -1) || (errMessage.indexOf("The request URI is not valid") != -1) || (errMessage.indexOf("Bad Request - Error in query synta") != -1))
                outputs.errorMessage = "Team ID should not contain invalid characters";
            else if (errMessage.indexOf("is not part of groupId") != -1)
                outputs.errorMessage = "The given channel is not a part of the given team";
            else if (errMessage.indexOf("Channel.DisplayName doesn't contain allowed characters") != -1)
                outputs.errorMessage =
                "Channel Name should not contain invalid characters";
            else if (errMessage.indexOf("Failed to execute Aad backend request GetUsersByObjectIdsS2SRequest") != -1)
                outputs.errorMessage = "Invalid User ID.";
        }
        if (inputs.status == 405 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Specified HTTP method is not allowed for the request target") != -1)
                outputs.errorMessage = "Team ID should not contain invalid characters";
        }
        if (inputs.status == 403 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if ((errMessage.indexOf("Cannot create channel on archived team") != -1) || (errMessage.indexOf("Cannot create a channel on archived team") != -1))
                outputs.errorMessage = "Cannot create a channel in an Archived Team.";
        }
        if (inputs.status == 502 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if ((errMessage.indexOf("Failed to execute backend request.") != -1))
                outputs.errorMessage = "User must be a member of the specified team.";
        }
        return outputs;
    },
    updateChannelErrorHandler: function(inputs, outputs) {
        var responseBody = new global.JSON().decode(inputs['responseBody']);
        var errMessage = "";
        outputs = this.teamErrorHandler(inputs, outputs);
        if (inputs.status == 400 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Channel id is not in a valid format") != -1)
                outputs.errorMessage = "The channel ID is not valid";
            else if ((errMessage.indexOf("The request URL is invalid") != -1) || (errMessage.indexOf("The request URI is not valid") != -1) || (errMessage.indexOf("Bad Request - Error in query synta") != -1) || (errMessage.indexOf("Channel.DisplayName doesn't contain allowed characters") != -1))
                outputs.errorMessage = "Input(s) should not contain invalid characters";
        }
        if (inputs.status == 403 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("General channel cannot be deleted") != -1)
                outputs.errorMessage = "General Channel cannot be deleted";
        }
        return outputs;
    },
    unarchiveTeamErrorHandler: function(inputs, outputs) {
        var responseBody = new global.JSON().decode(inputs['responseBody']);
        var errMessage = "";
        outputs = this.teamErrorHandler(inputs, outputs);
        if (inputs.status == 500 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Could not get archiving status") != -1)
                outputs.errorMessage = "The given team is already in unarchived state";
            outputs = this.genericErrorHandler(inputs, outputs);
        }
        return outputs;
    },
    userIdErrorHandler: function(inputs, outputs) {
        var responseBody = new global.JSON().decode(inputs['responseBody']);
        var errMessage = "";
        if (inputs.status == 403 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("General channel cannot be deleted") != -1)
                outputs.errorMessage = "General Channel cannot be deleted";
        }
        if (inputs.status == 400 && responseBody.error && responseBody.error.message) {
            errMessage = responseBody.error.message;
            if (errMessage.indexOf("Invalid UserId") != -1 || errMessage.indexOf("Bad Request") != -1)
                outputs.error_message = "Invalid User ID";
        }
        if(gs.nil(outputs.errorMessage) && gs.nil(outputs.error_message))
			outputs.error_message = responseBody.error.message;
        return outputs;
    },
    postMessageErrorHandler: function(inputs, outputs) {
        var errMessage = "";
        try {
            outputs = this.genericErrorHandler(inputs, outputs);
            var responseBody = new global.JSON().decode(inputs.responsebody);
            errMessage = responseBody.error.message;
            if ((inputs.status == 404 || inputs.status == 400) && responseBody.error && errMessage) {
                var channelMsg = errMessage.indexOf('teamGroupId needs to be a valid GUID.');
                if (errMessage.indexOf('teamGroupId needs to be a valid GUID.') != -1 || errMessage.indexOf('teamId needs to be a valid GUID.') != -1)
                    outputs.errorMessage = 'Invalid Group or Team ID.';
                else if (errMessage.indexOf('Bad Request') != -1) {
                    outputs.errorMessage = "The channel ID is not valid.";
                } else if (inputs.status == 400 && channelMsg != -1) {
                    outputs.errorMessage = "Group ID is not valid.";
                } else if (inputs.status == 404 && errMessage.indexOf('Not Found') != -1) {
                    outputs.errorMessage = "The channel ID is not valid.";
                } else if (inputs.status == 404 && responseBody.error.code.indexOf('Request_ResourceNotFound') != -1) {
                    outputs.errorMessage = "Invalid User ID/Principal Name";
                } else if (errMessage.indexOf('Invalid GUID') != -1 && errMessage.indexOf('for file attachment') != -1)
                    outputs.errorMessage = 'Invalid Attachment ID for Sharepoint Attachment.';
            }
        } catch (ex) {
            errMessage = "Error: " + ex;
            gs.error(ex);
        }
        return outputs.errorMessage || errMessage;
    },
    channelsErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error.message;
        if (inputs.statusCode == 401 && responseBody.error && responseBody.error.message) {
            outputs.errormessage = "Unauthorized";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.errormessage = "Access token is empty. Please Check Oauth Token and scope permission.";
        } else if (inputs.statusCode == 400 && responseBody.error && errMessage) {
            if (errMessage.indexOf("Failed to execute Skype backend request") != -1)
                outputs.errormessage = "The team you are trying to update is in Archived State";
            else if ((errMessage.indexOf("The request URL is invalid") != -1) || (errMessage.indexOf("The request URI is not valid") != -1) || (errMessage.indexOf("Bad Request - Error in query synta") != -1))
                outputs.errormessage = "Team ID should not contain invalid characters";
            else if (errMessage.indexOf("is not part of groupId") != -1)
                outputs.errormessage = "The given channel is not a part of the given team";
            else if (errMessage.indexOf("teamId needs to be a valid GUID") != -1)
                outputs.errormessage = "Team ID is invalid";
            else if (errMessage.indexOf("teamGroupId needs to be a valid GUID") != -1)
                outputs.errormessage = "Group ID is invalid";
            else if (errMessage.indexOf("Channel.DisplayName doesn't contain allowed characters") != -1)
                outputs.errormessage = "Channel Name should not contain invalid characters";
            else if (errMessage.indexOf("Bad Request") != -1)
                outputs.errormessage = "Invalid Channel ID.";
			else if (errMessage.indexOf("Operation not supported for this Channe") != -1)
				outputs.errormessage = "This operation is not allowed for channels with a membershipType value of standard.";
        } else if (inputs.statusCode == 410) {
            if (errMessage.indexOf("Gone") != -1)
                outputs.errormessage = "Invalid Channel ID.";
        } else if (inputs.statusCode == 404) {
            if (errMessage.indexOf("Not Found") != -1)
                outputs.errormessage = "Invalid Team ID.";
        }
        if (!outputs.errormessage)
            outputs.errormessage = errMessage;
        return outputs;
    },
    chatsErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error.message;
        if (inputs.statusCode == 401 && responseBody.error && responseBody.error.message) {
            outputs.errormessage = "Unauthorized";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.errormessage = "Access token is empty. Please Check Oauth Token and scope permission.";
        } else if (inputs.statusCode == 400 && responseBody.error && errMessage) {
            if (errMessage.indexOf("Bad Request") != -1)
                outputs.errormessage = "Invalid Chat ID";
			if(errMessage.indexOf("The caller must be one of the members") != -1)
				outputs.errormessage = "The caller's 'User ID / Principal Name' must be present in the array 'User IDs / Principal Names'.";
        } else if (inputs.statusCode == 410) {
            if (errMessage.indexOf("Gone") != -1)
                outputs.errormessage = "Invalid Channel ID.";
        } else if (inputs.statusCode == 404) {
            if (errMessage.indexOf("Not Found") != -1)
                outputs.errormessage = "Invalid Chat ID.";
		} else if (inputs.statusCode == 403) {
			if(errMessage.indexOf("AclCheckFailed") != -1)
				outputs.errormessage = "One of the 'User IDs / Principal Names' provided is invalid.";
		}
        if (!outputs.errormessage)
            outputs.errormessage = errMessage;
        return outputs;
    },
    subscribeWebhookErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error && responseBody.error.message ? responseBody.error.message : "";
        switch (inputs.statusCode) {
            case 401:
                outputs.error_message = "Unauthorized.";
                if (errMessage.indexOf("Access token is empty") != -1)
                    outputs.error_message = "Access token is empty. Please Check Oauth Token and scope permission.";
                else if (errMessage.indexOf("Access token has expired or is not yet valid") != -1)
                    outputs.error_message = "Invalid access token.";
                break;
            case 403:
                if (errMessage.indexOf("Status Code: Forbidden; Reason: Caller does not have access") != -1 && errMessage.indexOf("resource") != -1)
                    outputs.error_message = "Access denied to the specified resource.";
                else if (errMessage.indexOf("has reached its limit of") != -1 && errMessage.indexOf("subscription on tenant") != -1)
                    outputs.error_message = "Subscription limit reached for the specified resource.";
                break;
            case 400:
                if (errMessage.indexOf("expirationDateTime cannot come before the current time") != -1 || errMessage.indexOf("Payload 'expirationDateTime' property should be greater than current time") != -1)
                    outputs.error_message = "Expiration date time should be greater than current time.";
                else if (errMessage.indexOf("Subscription expiration can only be 60 minutes in the future") != -1)
                    outputs.error_message = "Expiration date time can only be 60 minutes in the future.";
                else if (errMessage.indexOf("Invalid 'changeType' attribute") != -1)
                    outputs.error_message = "Invalid Change Type.";
                else if (errMessage.indexOf("NotificationUrl scheme") != -1 && errMessage.indexOf("is not supported") != -1)
                    outputs.error_message = "Invalid Notification URL scheme.";
                else if (errMessage.indexOf("Invalid notification url") != -1)
                    outputs.error_message = "Invalid Notification URL.";
                else if (errMessage.indexOf("Subscription validation request failed") != -1)
                    outputs.error_message = "Subscription validation request failed.";
                else if ((errMessage.indexOf("Resource not found") != -1) || (errMessage.indexOf("Status Code: BadRequest; Reason: Resource with path") != -1 && errMessage.indexOf("is not supported") != -1))
                    outputs.error_message = "Invalid Resource.";
                else if ((errMessage.indexOf("Status Code: BadRequest; Reason: Subscription for resource") != -1 && errMessage.indexOf("is not supported") != -1) || errMessage.indexOf("Subscription is not supported for resource") != -1)
                    outputs.error_message = "Subscription for specified resource is not supported in specified API version.";
                else if (errMessage.indexOf("has reached its limit of") != -1 && errMessage.indexOf("subscription on tenant") != -1)
                    outputs.error_message = "Subscription limit reached for the specified resource.";
                break;
            default:
                outputs.error_message = errMessage;
        }
        if (!outputs.error_message)
            outputs.error_message = errMessage;
        return outputs;
    },
    subscriptionsErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error && responseBody.error.message ? responseBody.error.message : "";
        switch (inputs.statusCode) {
            case 401:
                outputs.error_message = "Unauthorized.";
                if (errMessage.indexOf("Access token is empty") != -1)
                    outputs.error_message = "Access token is empty. Please Check Oauth Token and scope permission.";
                else if (errMessage.indexOf("Access token has expired or is not yet valid") != -1)
                    outputs.error_message = "Invalid access token.";
                break;
            case 400:
                if (errMessage.indexOf("expirationDateTime cannot come before the current time") != -1 || errMessage.indexOf("Payload 'expirationDateTime' property should be greater than current time") != -1)
                    outputs.error_message = "Expiration date time should be greater than current time.";
                else if (errMessage.indexOf("Subscription expiration can only be 60 minutes in the future") != -1)
                    outputs.error_message = "Expiration date time can only be 60 minutes in the future.";
                break;
            case 404:
                if (errMessage.indexOf("The object was not found") != -1)
                    outputs.error_message = "Invalid Subscription ID.";
                break;
            default:
                outputs.error_message = errMessage;
        }
        if (!outputs.error_message)
            outputs.error_message = errMessage;
        return outputs;
    },
    lookUpMessageErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error.message;
        if (inputs.statusCode == 401 && responseBody.error && responseBody.error.message) {
            outputs.error_message = "Unauthorized.";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.error_message = "Access token is empty. Please Check Oauth Token and scope permission.";
        } else if (errMessage.indexOf("Bad Request") != -1)
            outputs.error_message = "One or more inputs are invalid.";
        else if (inputs.statusCode == 404 && errMessage.indexOf("Not Found") != -1)
            outputs.error_message = "Invalid Message ID.";
        else if (errMessage.indexOf('teamGroupId needs to be a valid GUID.') != -1 || errMessage.indexOf('teamId needs to be a valid GUID.') != -1)
            outputs.error_message = 'Invalid Chat or Team ID.';
        if (!outputs.error_message)
            outputs.error_message = errMessage;
        return outputs;
    },
    postReplyErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responsebody']);
        var errMessage = responseBody.error.message;
        if (inputs.status == 401 && responseBody.error && responseBody.error.message) {
            outputs.error_message = "Unauthorized.";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.error_message = "Access token is empty. Please Check Oauth Token and scope permission.";
        } else if (errMessage.indexOf("Bad Request") != -1 || errMessage.indexOf("404 page not found") != -1)
            outputs.error_message = "One or more inputs are invalid.";
        else if (inputs.status == 404 && (errMessage.indexOf("Not Found") != -1))
            outputs.error_message = "Invalid Message ID.";
        else if (errMessage.indexOf('teamGroupId needs to be a valid GUID.') != -1 || errMessage.indexOf('teamId needs to be a valid GUID.') != -1)
            outputs.error_message = 'Invalid Team ID.';
        else if (errMessage.indexOf('Invalid GUID') != -1 && errMessage.indexOf('for file attachment') != -1)
            outputs.error_message = 'Invalid Attachment ID for Sharepoint Attachment.';
        if (!outputs.error_message)
            outputs.error_message = errMessage;
		return outputs.error_message;
    },
    appErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error.message;
        if (inputs.status == 401 && errMessage) {
            outputs.errormessage = "Unauthorized.";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.errormessage = "Access token is empty. Please Check Oauth Token and scope permission.";
        } else if (errMessage.indexOf("Invalid UserId") != -1 || errMessage.indexOf("userId must be a GUID.") != -1 || errMessage.indexOf("Not Found") != -1)
            outputs.errormessage = "Invalid User ID.";
        if (!outputs.errormessage)
            outputs.errormessage = errMessage;
        return outputs;
    },
    deltaTokenErrorHandler: function(inputs, outputs) {
        var responseBody = JSON.parse(inputs['responseBody']);
        var errMessage = responseBody.error.message;
        if (inputs.status == 401 && errMessage) {
            outputs.error_message = "Unauthorized.";
            if (errMessage.indexOf("Access token is empty") != -1)
                outputs.error_message = "Access token is empty. Please Check Oauth Token and scope permission.";
        } else if (errMessage.indexOf('teamGroupId needs to be a valid GUID.') != -1 || errMessage.indexOf('teamId needs to be a valid GUID.') != -1)
            outputs.error_message = 'Invalid Team ID.';
        else if (errMessage.indexOf("Bad Request") != -1)
            outputs.error_message = "Invalid Channel ID.";
        else if (errMessage.indexOf("Badly formed token") != -1)
            outputs.error_message = "Invalid Next Token.";
        if (!outputs.error_message)
            outputs.error_message = errMessage;
    },
    getScheduleErrorHandler: function(inputs) {
        var error_message = '';
        var responseBody = inputs.responseBody;
        var response = new global.JSON().decode(responseBody);
        switch (String(inputs.statusCode)) {
            case "200":
                if (responseBody.indexOf('Unable to resolve e-mail address') != -1 || responseBody.indexOf('The email address provided is not a valid SMTP address') != -1)
                    error_message = "Some of the email addresses are not valid SMTP address or doesn't exist in active directory.";
                else if (responseBody.indexOf('too many calendar entries') != -1)
                    error_message = "Result set contains too many calendar entries.";
                break;
            case "400":
                if (responseBody.indexOf('ErrorInvalidTimeInterval') != -1)
                    error_message = "Time window is invalid. End date and time must be after start date and time.";
                else if (responseBody.indexOf('ErrorInvalidMergedFreeBusyInterval') != -1)
                    error_message = "The specified availability view interval is not valid. Specify an availability view interval that is less than the specified time duration and between 5 and 1440 minutes.";
                else if (responseBody.indexOf('ErrorTimeIntervalTooBig'))
                    error_message = "Time window must not exceed 62 days.";
                break;
            case "404":
                if (responseBody.indexOf('ResourceNotFound') != -1 || responseBody.indexOf('ErrorInvalidUser') != -1)
                    error_message = "Provided User ID is invalid.";
                break;
            case "429":
                error_message = "Too many requests.";
                break;
            default:
                error_message = response.error.message;
                break;
        }
        if (error_message == '')
            error_message = response.error.message;
        return error_message;
    },
    type: 'MSTeamsErrorHandler'
};]]></script>
    <sys_class_name>sys_script_include</sys_class_name>
    <sys_created_by>admin</sys_created_by>
    <sys_created_on>2019-02-27 10:30:24</sys_created_on>
    <sys_id>73186f76b7bb2300ce53d818ee11a97c</sys_id>
    <sys_mod_count>110</sys_mod_count>
    <sys_name>MSTeamsErrorHandler</sys_name>
    <sys_package display_value="Microsoft Teams Graph Spoke" source="sn_msteams_ahv2">05b59658b7332300ce53d818ee11a9eb</sys_package>
    <sys_policy>read</sys_policy>
    <sys_scope display_value="Microsoft Teams Graph Spoke">05b59658b7332300ce53d818ee11a9eb</sys_scope>
    <sys_update_name>sys_script_include_73186f76b7bb2300ce53d818ee11a97c</sys_update_name>
    <sys_updated_by>admin</sys_updated_by>
    <sys_updated_on>2023-05-10 10:09:51</sys_updated_on>
  </sys_script_include>
</record_update>
